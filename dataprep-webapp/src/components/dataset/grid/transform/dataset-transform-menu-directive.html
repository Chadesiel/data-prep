<li ng-click="menuCtrl.select()"
    ng-class="::{divider: menuCtrl.item.isDivider}">

    <span ng-if="::(!menuCtrl.item.isDivider)">
        <a href="#">
            {{::menuCtrl.item.name}}
        </a>

        <!-- Params and choice modal -->
        <talend-modal ng-if="::(menuCtrl.item.parameters || menuCtrl.item.choice)"
                      fullscreen="false"
                      state="menuCtrl.showModal"
                      close-button="true">

            <form ng-submit="menuCtrl.transformWithParam()" name="menuCtrl.paramForm">
                <!-- Menu item param -->
                <table ng-if="menuCtrl.item.parameters" class="param">
                    <tr ng-repeat="param in ::menuCtrl.item.parameters track by $index">
                        <td class="param-name">{{::param.name}} :</td>
                        <td class="param-input">
                            <input name="{{::(param.name + $index)}}"
                                   type="{{::param.inputType}}"
                                   placeholder="Default '{{::param.default}}'"
                                   ng-model="param.value"
                                   type-validation="{{::param.type}}"/>

                            <span class="error" ng-if="menuCtrl.paramForm[param.name + $index].$error.typeValidation || menuCtrl.paramForm[param.name + $index].$error.number">
                                This must be a {{::param.type}}
                            </span>
                        </td>

                    </tr>
                </table>

                <!-- Choice -->
                <table ng-if="::(menuCtrl.item.choice.values)" class="param-choice">
                    <tr>
                        <td class="param-choice-name">Option :</td>
                        <td class="param-choice-select"><select
                                ng-model="menuCtrl.item.choice.selectedValue"
                                ng-options="option as option.name for option in ::menuCtrl.item.choice.values"
                                required></select>
                        </td>
                    </tr>

                    <!-- Choice params -->
                    <tbody ng-repeat="option in ::menuCtrl.item.choice.values track by $index"
                           ng-if="option.parameters && menuCtrl.item.choice.selectedValue === option">
                        <tr ng-repeat="param in ::option.parameters track by $index">
                            <td class="param-name">{{::param.name}} :</td>
                            <td class="param-input">
                                <input name="{{::(param.name + $index)}}"
                                       type="{{::param.inputType}}"
                                       placeholder="Default '{{::param.default}}'"
                                       ng-model="param.value"
                                       type-validation="{{::param.type}}"/>

                                <span class="error" ng-if="menuCtrl.paramForm[param.name + $index].$error.typeValidation || menuCtrl.paramForm[param.name + $index].$error.number">
                                    This must be a value of type : {{::param.type}}
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <button ng-disabled="menuCtrl.paramForm.$invalid">Submit</button>
            </form>
        </talend-modal>
    </span>
</li>
