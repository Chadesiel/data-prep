<talend-accordions>
    <talend-accordions-item ng-repeat="step in recipeCtrl.recipe track by step.transformation.stepId"
                            ng-class="{'inactive': step.inactive}"
                            on-open="recipeCtrl.resetParams(step)"
                            default="$index === (recipeCtrl.recipe.length - 1)">
        <div class="trigger step-description"
             ng-click="recipeCtrl.showModal[$index] = !!step.transformation.cluster"
             ng-switch="step.actionParameters.parameters.scope">

            {{$index + 1}}.
            <span class="recipe-description">{{step.transformation.label}}</span>

            <span ng-switch-when="column">
                {{::'RECIPE_ITEM_ON_COL' | translate}}
                <span class="recipe-description recipe-column-name">{{step.column.name}}</span>
            </span>
            <span ng-switch-when="cell">
                {{::'RECIPE_ITEM_ON_CELL' | translate}}
            </span>

            <recipe-bullet class="step-trigger" step="step" ></recipe-bullet>
        </div>

        <div class="content">
            <transform-params ng-if="(step.transformation.parameters.length || step.transformation.items.length)"
                              transformation="step.transformation"
                              on-submit="recipeCtrl.stepUpdateClosure(step)(params)"
                              on-submit-hover-on="recipeCtrl.previewUpdateClosure(step)(params)"
                              on-submit-hover-off="recipeCtrl.cancelPreview()"></transform-params>

            <talend-modal ng-if="step.transformation.cluster"
                          fullscreen="false"
                          state="recipeCtrl.showModal[$index]"
                          close-button="true">

                <div class="modal-title">{{ step.transformation.label }}</div>
                <div class="modal-subtitle">{{ step.transformation.description }}</div>

                <transform-params transformation="step.transformation"
                                  on-submit="recipeCtrl.stepUpdateClosure(step)(params)"></transform-params>

            </talend-modal>
        </div>
    </talend-accordions-item>
</talend-accordions>