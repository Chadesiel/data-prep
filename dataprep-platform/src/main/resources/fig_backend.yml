mongodb:
    image: mongodb
    volumes:
        - runtime/mongodb:/data/db
    expose:
        - 27017
api:
    image: talend/dataprep-api:1.0.m3-SNAPSHOT
    expose:
        - 8888
    ports:
        - "8888:8888"
    links:
        - transform
        - dataset
        - preparation
    environment:
        TDP_API_SERVER_PORT: 8888
        TDP_API_DATASET_SERVICE_URL: http://${DATASET_PORT_8080_TCP_ADDR}:${DATASET_PORT_8080_TCP_PORT}/datasets
        TDP_API_TRANSFORMATION_SERVICE_URL: http://${TRANSFORM_PORT_8180_TCP_ADDR}:${TRANSFORM_1_PORT_8180_TCP_PORT}
        TDP_API_PREPARATION_SERVICE_URL: http://${PREPARATION_PORT_9090_TCP_ADDR}:${PREPARATION_1_PORT_9090_TCP_PORT}
transform:
    image: talend/dataprep-transformation:1.0.m3-SNAPSHOT
    volumes:
        - runtime/dataset/store:/store
    expose:
        - 8180
    environment:
        TDP_TRANSFORMATION_SERVER_PORT: 8180
dataset:
    image: talend/dataprep-dataset:1.0.m3-SNAPSHOT
    volumes:
        - runtime/dataset/store:/store
    expose:
        - 8080
    links:
        - mongodb
    environment:
        TDP_DATASET_SERVER_PORT: 8080
        TDP_DATASET_METADATA_STORE: mongodb
        TDP_DATASET_CONTENT_STORE: local
        TDP_DATASET_CONTENT_STORE_LOCAL_LOCATION: /store
        TDP_DATASET_MONGODB_HOST: ${MONGODB_PORT_27017_TCP_ADDR}
        TDP_DATASET_MONGODB_PORT: ${MONGODB_PORT_27017_TCP_PORT}
preparation:
    image: talend/dataprep-preparation:1.0.m3-SNAPSHOT
    expose:
        - 9090
    links:
        - mongodb
    environment:
        TDP_PREPARATION_SERVER_PORT: 9090
        TDP_PREPARATION_STORE: mongodb
        TDP_PREPARATION_MONGODB_HOST: ${MONGODB_PORT_27017_TCP_ADDR}
        TDP_PREPARATION_MONGODB_PORT: ${MONGODB_PORT_27017_TCP_PORT}

